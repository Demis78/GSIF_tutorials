library(GSIF)
library(plotKML)
library(RCurl)
library(sp)
library(rgdal)
nl.rd <- getURL("http://spatialreference.org/ref/sr-org/6781/proj4/")
## Geul data:
geul <- read.table("geul.dat", header = TRUE)
coordinates(geul) <- ~x+y
proj4string(geul) <- CRS(nl.rd) 
grd25 <- readGDAL("dem25.txt")
names(grd25) = "dem"
# grd25$river <- factor(readGDAL("river.txt")$band1, labels = "River")
grd25$dis <- readGDAL("riverdist.txt")$band1
## mask out missing pixels:
grd25 <- as(grd25, "SpatialPixelsDataFrame")
proj4string(grd25) <- CRS(nl.rd) 
?predict.gstatModel
grd25.spc <- spc(grd25, ~ dem+dis)
m = pb ~ PC1+PC2
pbm <- fit.gstatModel(m, observations=geul, grd25.spc@predicted, family=gaussian(link=log))
pb.rk <- predict(pbm, grd25.spc@predicted)
pb.rks <- predict(pbm, grd25.spc@predicted, nsim=20, block = c(0,0))
show(pb.rk)
plotKML(pb.rks, png.width=grd25@grid@cells.dim[1]*10, png.height=grd25@grid@cells.dim[2]*10)
?RSAGA
writeGDAL(grd25["dem"], "dem.sgrd", "SAGA", mvFlag=-99999)
getwd()
?writeGDAL
writeGDAL(grd25["dem"], "dem.sdat", "SAGA", mvFlag=-99999)
rsaga.wetness.index("dem.sgrd","swi.sgrd")
library(RSAGA)
rsaga.wetness.index("dem.sgrd","swi.sgrd")
grd25$swi <- readGDAL("swi.sdat")$band1
str(grd25)
grd25$swi[grd25@grid.index] <- readGDAL("swi.sdat")$band1
grd25$swi <- readGDAL("swi.sdat")$band1[grd25@grid.index]
grd25.spc2 <- spc(grd25, ~ dem+dis+swi)
m2 = pb ~ PC1+PC2+PC3
pbm2 <- fit.gstatModel(m2, observations=geul, grd25.spc2@predicted, family=gaussian(link=log))
spplot(grd25.spc2@predicted)
m2 = log1p(pb) ~ PC1+PC2+PC3
pbm2 <- fit.gstatModel(m2, observations=geul, grd25.spc2@predicted)
q()
